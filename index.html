<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<!--	<meta name="description" content="">-->
	<!--	<meta name="HandheldFriendly" content="True">-->
	<!--	<meta name="MobileOptimized" content="320">-->
	<meta name="viewport" content="initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<title>使用手册 | GoPay</title>
	<link rel="alternate" type="application/rss+xml" title="" href="feed/index.html">
	<link rel="stylesheet" href="css/style.css">
	<link rel="stylesheet" href="css/prism.css">
	<link rel="icon" href="img/gopay.png">
</head>
<body>
<script src="js/jquery.min.js"></script>
<script src="js/layout.js"></script>
<script type="text/javascript" src="js/prism.js"></script>
<div class="wrapper">
	<nav>
		<div class="pull-left">
			<img style="height: 50px;width: 50px; margin-left: 20px" src="img/gopay.png" alt="GoPay"/>
			<span style="margin-left: 10px">GoPay</span>
		</div>
	</nav>
	<header>
		<div>
			<div class="nav-title">
				<h2 class="lone-header" style="margin-left: 40px;">微信支付（WeChat）、支付宝支付（Alipay）的Go版本SDK</h2>
				<h2 class="lone-header" style="margin-right: 40px;">jerry@gopay.ink</h2>
			</div>
		</div>
	</header>
	<section>
		<div class="container">
			<ul class="docs-nav">
				<li><strong>概述</strong></li>
				<li><a href="#introduce" class="cc-active">简介</a></li>
				<li><a href="#install" class="cc-active">安装</a></li>
				<li><a href="#license" class="cc-active">License</a></li>
				<li class="separator"></li>
				<li><strong>微信</strong></li>
				<li><a href="#wechat_tip" class="cc-active">声明</a></li>
				<li><a href="#wechat_api" class="cc-active">微信支付API</a></li>
				<li>
					<ul>
						<li><a href="#UnifiedOrder" class="cc-active">统一下单</a></li>
						<li><a href="#Micropay" class="cc-active">提交付款码支付</a></li>
						<li><a href="#QueryOrder" class="cc-active">查询订单</a></li>
						<li><a href="#CloseOrder" class="cc-active">关闭订单</a></li>
						<li><a href="#Reverse" class="cc-active">撤销订单</a></li>
						<li><a href="#Refund" class="cc-active">申请退款</a></li>
						<li><a href="#QueryRefund" class="cc-active">查询退款</a></li>
						<li><a href="#DownloadBill" class="cc-active">下载对账单</a></li>
						<li><a href="#DownloadFundFlow" class="cc-active">下载资金账单</a></li>
						<li><a href="#BatchQueryComment" class="cc-active">拉取订单评价数据</a></li>
					</ul>
				</li>
				<li><a href="#gopay_wechat_api" class="cc-active">GoPay微信公共API</a></li>
				<li>
					<ul>
						<li><a href="#GetMiniPaySign">GetMiniPaySign</a></li>
						<li><a href="#GetH5PaySign">GetH5PaySign</a></li>
						<li><a href="#GetAppPaySign">GetAppPaySign</a></li>
						<li><a href="#ParseNotifyResult" class="cc-active">ParseNotifyResult</a></li>
						<li><a href="#VerifyPayResultSign" class="cc-active">VerifyPayResultSign</a></li>
						<li><a href="#Code2Session" class="cc-active">Code2Session</a></li>
						<li><a href="#GetAccessToken" class="cc-active">GetAccessToken</a></li>
						<li><a href="#GetPaidUnionId" class="cc-active">GetPaidUnionId</a></li>
						<li><a href="#GetWeChatUserInfo" class="cc-active">GetWeChatUserInfo</a></li>
						<li><a href="#DecryptOpenDataToStruct" class="cc-active">DecryptOpenDataToStruct</a></li>
						<li><a href="#GetOpenIdByAuthCode" class="cc-active">GetOpenIdByAuthCode</a></li>
					</ul>
				</li>
				<li><a href="#animation_style" class="cc-active">Animation Styles</a></li>
				<li><a href="#bars_text" class="cc-active">Bars Text</a></li>
				<li><a href="#vote_counter" class="cc-active">Vote Counter</a></li>
				<li><strong>支付宝</strong></li>
				<li><a href="#rating_icons" class="cc-active">Rating Icons</a></li>
				<li><a href="#rating_titles" class="cc-active">Rating Titles</a></li>
				<li><a href="#bar_colors" class="cc-active">Bar Colors</a></li>
			</ul>
			<div class="docs-content">
				<!--简介-->
				<h3 id="introduce"> 简介</h3>
				<p> 微信支付（WeChat）、支付宝支付（Alipay）的Go版本SDK</p>
				<p> 技术栈：</p>
				<ul>
					<li><a href="https://golang.google.cn" target="_blank">Golang</a></li>
					<li><a href="https://github.com/parnurzeal/gorequest" target="_blank">gorequest</a></li>
				</ul>
				<!--安装-->
				<h3 id="install"> 安装</h3>
				<div>
					<pre><code class="language-bash">go get -u github.com/iGoogle-ink/gopay</code></pre>
				</div>
				<!--License-->
				<h3 id="license"> License</h3>
				<div style="padding:1px 30px 1px 30px;background-color: #F5F5F5">
					<p> Copyright 2019 Jerry</p>
					<p> Licensed under the Apache License, Version 2.0 (the "License");
						you may not use this file except in compliance with the License.
						<br>You may obtain a copy of the License at</p>

					<p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http://www.apache.org/licenses/LICENSE-2.0</p>

					<p>Unless required by applicable law or agreed to in writing, software
						distributed under the License is distributed on an "AS IS" BASIS,
						WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
						See the License for the specific language governing permissions and
						limitations under the License.</p>
				</div>
				<hr>
				<!--声明-->
				<h3 id="wechat_tip"> 声明</h3>
				<p style="font-weight: bold">
					<text style="color: red">注意：</text>
					具体参数根据请求的不同而不同，请参考微信官方文档的参数说明！
				</p>
				<p style="font-weight: bold">参考文档：<a href="https://pay.weixin.qq.com/wiki/doc/api/index.html"
													 target="_blank">微信支付文档</a></p>
				<hr>
				<!--微信支付API-->
				<h3 id="wechat_api"> 微信支付API</h3>
				<ul style="font-weight: bold">
					<li><a href="#UnifiedOrder">统一下单：</a>client.UnifiedOrder()
						<ul>
							<li>JSAPI - JSAPI支付</li>
							<li>JSAPI - 微信小程序支付</li>
							<li>NATIVE - Native支付</li>
							<li>APP - App支付</li>
							<li>MWEB - H5支付</li>
						</ul>
					</li>
					<li><a href="#Micropay">提交付款码支付：</a>client.Micropay()</li>
					<li><a href="#QueryOrder">查询订单：</a>client.QueryOrder()</li>
					<li><a href="#CloseOrder">关闭订单：</a>client.CloseOrder()</li>
					<li><a href="#Reverse">撤销订单：</a>client.Reverse()</li>
					<li><a href="#Refund">申请退款：</a>client.Refund()</li>
					<li><a href="#QueryRefund">查询退款：</a>client.QueryRefund()</li>
					<li><a href="#DownloadBill">下载对账单：</a>client.DownloadBill()</li>
					<li><a href="#DownloadFundFlow">下载资金账单：</a>client.DownloadFundFlow()</li>
					<li><a href="#BatchQueryComment">拉取订单评价数据：</a>client.BatchQueryComment()</li>
				</ul>

				<hr>
				<!--统一下单-->
				<ul style="font-weight: bold">
					<li id="UnifiedOrder">统一下单</li>
				</ul>
				<pre class="line-numbers"><code class="language-go">//初始化微信客户端
//    appId：应用ID
//    MchID：商户ID
//    apiKey：API秘钥值
//    isProd：是否是正式环境
client := gopay.NewWeChatClient(AppID, MchID, ApiKey, false)

//初始化参数Map
body := make(gopay.BodyMap)
body.Set("nonce_str", gopay.GetRandomString(32))
body.Set("body", "测试支付")
number := gopay.GetRandomString(32)
fmt.Println("out_trade_no:", number)
body.Set("out_trade_no", number)
body.Set("total_fee", 10)
body.Set("spbill_create_ip", "124.77.173.62")
body.Set("notify_url", "http://www.gopay.ink")
body.Set("trade_type", gopay.TradeType_JsApi)
body.Set("device_info", "WEB")
body.Set("sign_type", gopay.SignType_MD5)
//body.Set("scene_info", `{"h5_info": {"type":"Wap","wap_url": "http://www.gopay.ink","wap_name": "测试支付"}}`)
body.Set("openid", OpenID)

//请求支付下单，成功后得到结果
wxRsp, err := client.UnifiedOrder(body)
if err != nil {
	fmt.Println("Error:", err)
	return
}
fmt.Println("wxRsp:", *wxRsp)</code></pre>
				<!--提交付款码支付-->
				<ul style="font-weight: bold">
					<li id="Micropay">提交付款码支付</li>
				</ul>
				<pre class="line-numbers"><code class="language-go">//初始化微信客户端
//    appId：应用ID
//    MchID：商户ID
//    ApiKey：Key值
//    isProd：是否是正式环境
client := gopay.NewWeChatClient(AppID, MchID, ApiKey, true)

//初始化参数Map
body := make(gopay.BodyMap)
body.Set("nonce_str", gopay.GetRandomString(32))
body.Set("body", "扫用户付款码支付")
number := gopay.GetRandomString(32)
fmt.Println("out_trade_no:", number)
body.Set("out_trade_no", number)
body.Set("total_fee", 1)
body.Set("spbill_create_ip", "124.77.173.62")
body.Set("auth_code", "134518243599425392")
body.Set("sign_type", gopay.SignType_MD5)

//请求支付，成功后得到结果
wxRsp, err := client.Micropay(body)
if err != nil {
	fmt.Println("Error:", err)
	return
}
fmt.Println("wxRsp:", *wxRsp)</code></pre>
				<!--查询订单-->
				<ul style="font-weight: bold">
					<li id="QueryOrder">查询订单</li>
				</ul>
				<pre class="line-numbers"><code class="language-go">//初始化微信客户端
//    appId：应用ID
//    MchID：商户ID
//    apiKey：API秘钥值
//    isProd：是否是正式环境
client := gopay.NewWeChatClient(AppID, MchID, ApiKey, false)

//初始化参数结构体
body := make(gopay.BodyMap)
body.Set("out_trade_no", "GYWX201901301040355706100401")
body.Set("nonce_str", gopay.GetRandomString(32))
body.Set("sign_type", gopay.SignType_MD5)

//请求订单查询，成功后得到结果
wxRsp, err := client.QueryOrder(body)
if err != nil {
	fmt.Println("Error:", err)
	return
}
fmt.Println("wxRsp：", *wxRsp)</code></pre>
				<!--关闭订单-->
				<ul style="font-weight: bold">
					<li id="CloseOrder">关闭订单</li>
				</ul>
				<pre class="line-numbers"><code class="language-go">//初始化微信客户端
//    appId：应用ID
//    MchID：商户ID
//    apiKey：API秘钥值
//    isProd：是否是正式环境
client := gopay.NewWeChatClient(AppID, MchID, ApiKey, false)

//初始化参数结构体
body := make(gopay.BodyMap)
body.Set("out_trade_no", "GYWX201901301040355706100401")
body.Set("nonce_str", gopay.GetRandomString(32))
body.Set("sign_type", gopay.SignType_MD5)

//请求关闭订单，成功后得到结果
wxRsp, err := client.CloseOrder(body)
if err != nil {
	fmt.Println("Error:", err)
	return
}
fmt.Println("wxRsp：", *wxRsp)</code></pre>
				<!--撤销订单-->
				<ul style="font-weight: bold">
					<li id="Reverse">撤销订单</li>
				</ul>
				<pre class="line-numbers"><code class="language-go">//初始化微信客户端
//    appId：应用ID
//    MchID：商户ID
//    ApiKey：Key值
//    isProd：是否是正式环境
client := gopay.NewWeChatClient(AppID, MchID, ApiKey, false)

//初始化参数Map
body := make(gopay.BodyMap)
body.Set("nonce_str", gopay.GetRandomString(32))
body.Set("out_trade_no", "GYWX201901301040355706100401")
body.Set("sign_type", gopay.SignType_MD5)

//请求撤销订单，成功后得到结果，沙箱环境下，证书路径参数可传空
wxRsp, err := client.Reverse(body, "apiclient_cert.pem", "apiclient_key.pem", "apiclient_cert.p12")
if err != nil {
	fmt.Println("Error:", err)
	return
}
fmt.Println("wxRsp:", *wxRsp)
}</code></pre>
				<!--申请退款-->
				<ul style="font-weight: bold">
					<li id="Refund">申请退款</li>
				</ul>
				<pre class="line-numbers"><code class="language-go">//初始化微信客户端
//    appId：应用ID
//    MchID：商户ID
//    ApiKey：Key值
//    isProd：是否是正式环境
client := gopay.NewWeChatClient(AppID, MchID, ApiKey, false)

//初始化参数结构体
body := make(gopay.BodyMap)
body.Set("out_trade_no", "97HiM5j6kGmM2fk7fYMc8MgKhPnEQ5Rk")
body.Set("nonce_str", gopay.GetRandomString(32))
body.Set("sign_type", gopay.SignType_MD5)
s := gopay.GetRandomString(64)
fmt.Println("s:", s)
body.Set("out_refund_no", s)
body.Set("total_fee", 1)
body.Set("refund_fee", 1)

//请求申请退款（沙箱环境下，证书路径参数可传空）
//    body：参数Body
//    certFilePath：cert证书路径
//    keyFilePath：Key证书路径
//    pkcs12FilePath：p12证书路径
wxRsp, err := client.Refund(body, "apiclient_cert.pem", "apiclient_key.pem", "apiclient_cert.p12")
if err != nil {
	fmt.Println("Error:", err)
	return
}
fmt.Println("wxRsp：", *wxRsp)</code></pre>
				<!--查询退款-->
				<ul style="font-weight: bold">
					<li id="QueryRefund">查询退款</li>
				</ul>
				<pre class="line-numbers"><code class="language-go">//初始化微信客户端
//    appId：应用ID
//    MchID：商户ID
//    ApiKey：Key值
//    isProd：是否是正式环境
client := gopay.NewWeChatClient(AppID, MchID, ApiKey, false)

//初始化参数结构体
body := make(gopay.BodyMap)
body.Set("out_refund_no", "vk4264I1UQ3Hm3E4AKsavK8npylGSgQA092f9ckUxp8A2gXmnsLEdsupURVTcaC7")
body.Set("nonce_str", gopay.GetRandomString(32))
body.Set("sign_type", gopay.SignType_MD5)

//请求查询退款
wxRsp, err := client.QueryRefund(body)
if err != nil {
	fmt.Println("Error:", err)
	return
}
fmt.Println("wxRsp：", *wxRsp)</code></pre>
				<!--下载对账单-->
				<ul style="font-weight: bold">
					<li id="DownloadBill">下载对账单</li>
				</ul>
				<pre class="line-numbers"><code class="language-go">//初始化微信客户端
//    appId：应用ID
//    MchID：商户ID
//    ApiKey：Key值
//    isProd：是否是正式环境
client := gopay.NewWeChatClient(AppID, MchID, ApiKey, false)

//初始化参数结构体
body := make(gopay.BodyMap)
body.Set("nonce_str", gopay.GetRandomString(32))
body.Set("sign_type", gopay.SignType_MD5)
body.Set("bill_date", "20190122")
body.Set("bill_type", "ALL")

//请求下载对账单，成功后得到结果（string类型字符串）
wxRsp, err := client.DownloadBill(body)
if err != nil {
	fmt.Println("Error:", err)
	return
}
fmt.Println("wxRsp：", wxRsp)</code></pre>
				<!--下载资金账单-->
				<ul style="font-weight: bold">
					<li id="DownloadFundFlow">下载资金账单</li>
				</ul>
				<pre class="line-numbers"><code class="language-go">//初始化微信客户端
//    appId：应用ID
//    MchID：商户ID
//    ApiKey：Key值
//    isProd：是否是正式环境
//    好像不支持沙箱环境，因为沙箱环境默认需要用MD5签名，但是此接口仅支持HMAC-SHA256签名
client := gopay.NewWeChatClient(AppID, MchID, ApiKey, true)

//初始化参数结构体
body := make(gopay.BodyMap)
body.Set("nonce_str", gopay.GetRandomString(32))
body.Set("sign_type", gopay.SignType_HMAC_SHA256)
body.Set("bill_date", "20190122")
body.Set("account_type", "Basic")

//请求下载资金账单，成功后得到结果
wxRsp, err := client.DownloadFundFlow(body, "apiclient_cert.pem", "apiclient_key.pem", "apiclient_cert.p12")
if err != nil {
	fmt.Println("Error:", err)
	return
}
fmt.Println("wxRsp：", wxRsp)</code></pre>
				<!--拉取订单评价数据-->
				<ul style="font-weight: bold">
					<li id="BatchQueryComment">拉取订单评价数据</li>
				</ul>
				<pre class="line-numbers"><code class="language-go">//初始化微信客户端
//    appId：应用ID
//    MchID：商户ID
//    ApiKey：Key值
//    isProd：是否是正式环境
//    好像不支持沙箱环境，因为沙箱环境默认需要用MD5签名，但是此接口仅支持HMAC-SHA256签名
client := NewWeChatClient(AppID, MchID, ApiKey, true)

//初始化参数结构体
body := make(gopay.BodyMap)
body.Set("nonce_str", gopay.GetRandomString(32))
body.Set("sign_type", gopay.SignType_HMAC_SHA256)
body.Set("begin_time", "20190120000000")
body.Set("end_time", "20190122174000")
body.Set("offset", "0")

//请求拉取订单评价数据，成功后得到结果，沙箱环境下，证书路径参数可传空
wxRsp, err := client.BatchQueryComment(body, "apiclient_cert.pem", "apiclient_key.pem", "apiclient_cert.p12")
if err != nil {
	fmt.Println("Error:", err)
	return
}
fmt.Println("Response：", wxRsp)</code></pre>

				<!---------------------------------------------------------->
				<hr>
				<!--GoPay微信公共API-->
				<h3 id="gopay_wechat_api"> GoPay微信公共API</h3>
				<ul style="font-weight: bold">
					<li><a href="#GetMiniPaySign">获取微信小程序支付所需要的paySign：</a>gopay.GetMiniPaySign()</li>
					<li><a href="#GetH5PaySign">获取微信内H5支付所需要的paySign：</a>gopay.GetH5PaySign()</li>
					<li><a href="#GetAppPaySign">获取APP支付所需要的paySign：</a>gopay.GetAppPaySign()</li>
					<li><a href="#ParseNotifyResult">解析并返回微信支付异步通知的参数：</a>gopay.ParseNotifyResult()</li>
					<li><a href="#VerifyPayResultSign">微信支付异步通知的签名验证和返回参数验签后的Sign：</a>gopay.VerifyPayResultSign()</li>
					<li><a href="#Code2Session">登录凭证校验：获取微信用户OpenId、UnionId、SessionKey：</a>gopay.Code2Session()</li>
					<li><a href="#GetAccessToken">获取小程序全局唯一后台接口调用凭据：</a>gopay.GetAccessToken()</li>
					<li><a href="#GetPaidUnionId">用户支付完成后，获取该用户的 UnionId，无需用户授权：</a>gopay.GetPaidUnionId()</li>
					<li><a href="#GetWeChatUserInfo">微信公众号：获取用户基本信息(UnionID机制)：</a>gopay.GetWeChatUserInfo()</li>
					<li><a href="#DecryptOpenDataToStruct">将“加密数据”解密到指定结构体：</a>gopay.DecryptOpenDataToStruct()</li>
					<li><a href="#GetOpenIdByAuthCode">授权码查询openid：</a>gopay.GetOpenIdByAuthCode()</li>
				</ul>

				<hr>
				<!--GetMiniPaySign-->
				<ul>
					<li id="GetMiniPaySign">GetMiniPaySign</li>
					<ul>
						<li>统一下单成功后，需要进一步获取微信小程序支付所需要的paySign</li>
						<li>微信小程序支付官方文档：<a target="_blank" href="https://developers.weixin.qq.com/miniprogram/dev/api/open-api/payment/wx.requestPayment.html">微信小程序支付API</a></li>
					</ul>
				</ul>
				<pre class="line-numbers"><code class="language-go">timeStamp := strconv.FormatInt(time.Now().Unix(), 10)
packages := "prepay_id=" + wxRsp.PrepayId   //此处的 wxRsp.PrepayId ,统一下单成功后得到
//    appId：APPID
//    nonceStr：随即字符串
//    prepayId：统一下单成功后得到的值
//    signType：签名类型
//    timeStamp：时间
//    apiKey：API秘钥值
paySign := gopay.GetMiniPaySign(AppID, wxRsp.NonceStr, packages, gopay.SignType_MD5, timeStamp, ApiKey)

//微信小程序支付需要的参数信息
fmt.Println("paySign：", paySign)</code></pre>

				<!--GetH5PaySign-->
				<ul>
					<li id="GetH5PaySign">GetH5PaySign</li>
					<ul>
						<li>统一下单成功后，需要进一步获取微信内H5支付所需要的paySign</li>
						<li>微信内H5支付官方文档：<a target="_blank" href="https://pay.weixin.qq.com/wiki/doc/api/external/jsapi.php?chapter=7_7&index=6">微信内H5支付文档</a></li>
					</ul>
				</ul>
				<pre class="line-numbers"><code class="language-go">timeStamp := strconv.FormatInt(time.Now().Unix(), 10)
packages := "prepay_id=" + wxRsp.PrepayId   //此处的 wxRsp.PrepayId ,统一下单成功后得到
//    appId：APPID
//    nonceStr：随即字符串
//    prepayId：统一下单成功后得到的值
//    signType：签名类型
//    timeStamp：时间
//    apiKey：API秘钥值
paySign := gopay.GetH5PaySign(AppID, wxRsp.NonceStr, packages, gopay.SignType_MD5, timeStamp, ApiKey)

//微信内H5支付需要的参数信息
fmt.Println("paySign：", paySign)</code></pre>

				<!--GetAppPaySign-->
				<ul>
					<li id="GetAppPaySign">GetAppPaySign</li>
					<ul>
						<li>统一下单成功后，需要进一步获取APP支付所需要的paySign</li>
						<li>APP支付官方文档：<a target="_blank" href="https://pay.weixin.qq.com/wiki/doc/api/app/app.php?chapter=9_12">APP端调起支付的参数列表文档</a></li>
					</ul>
				</ul>
				<pre class="line-numbers"><code class="language-go">timeStamp := strconv.FormatInt(time.Now().Unix(), 10)
//注意：signType：此处签名方式，务必与统一下单时用的签名方式一致
//注意：package：参数因为是固定值，不需开发者再传入
//    appId：APPID
//    partnerid：partnerid
//    nonceStr：随即字符串
//    prepayId：统一下单成功后得到的值
//    signType：此处签名方式，务必与统一下单时用的签名方式一致
//    timeStamp：时间
//    apiKey：API秘钥值
paySign := gopay.GetAppPaySign(appid, partnerid, wxRsp.NonceStr, prepayid, gopay.SignType_MD5, timeStamp, apiKey)

//APP支付需要的参数信息
fmt.Println("paySign：", paySign)</code></pre>

				<!--ParseNotifyResult-->
				<ul>
					<li id="ParseNotifyResult">ParseNotifyResult</li>
					<ul>
						<li>微信支付后的异步通知文档：<a target="_blank" href="https://pay.weixin.qq.com/wiki/doc/api/wxa/wxa_api.php?chapter=9_7&index=8">支付结果通知</a></li>
					</ul>
				</ul>
				<pre class="line-numbers"><code class="language-go">//解析支付完成后的异步通知参数信息
//此处 c.Request() 为 *http.Request
notifyRsp, err := gopay.ParseNotifyResult(c.Request())
if err != nil {
    fmt.Println("err:", err)
}
fmt.Println("notifyRsp:", *notifyRsp)</code></pre>
				<!--VerifyPayResultSign-->
				<ul>
					<li id="VerifyPayResultSign">VerifyPayResultSign</li>
				</ul>
				<pre class="line-numbers"><code class="language-go">//支付通知的签名验证和参数签名后的Sign
//    apiKey：API秘钥值
//    signType：签名类型 MD5 或 HMAC-SHA256（默认请填写 MD5）
//    notifyRsp：利用 gopay.ParseNotifyResult() 得到的结构体
//    返回参数ok：是否验证通过
//    返回参数sign：根据参数计算的sign值，非微信返回参数中的Sign
ok, sign := gopay.VerifyPayResultSign(ApiKey, gopay.SignType_MD5, notifyRsp)
log.Println("ok:", ok)
log.Println("sign:", sign)</code></pre>
				<!--Code2Session-->
				<ul>
					<li id="Code2Session">Code2Session</li>
				</ul>
				<pre class="line-numbers"><code class="language-go">//获取微信用户的OpenId、SessionKey、UnionId
//    appId:APPID
//    appSecret:AppSecret
//    wxCode:小程序调用wx.login 获取的code
userIdRsp, err := gopay.Code2Session(AppID, APPSecret, "011EZg6p0VO47n1p2W4p0mle6p0EZg6u")
if err != nil {
	fmt.Println("err:", err)
	return
}
fmt.Println("SessionKey:", userIdRsp.SessionKey)
fmt.Println("ExpiresIn:", userIdRsp.ExpiresIn)
fmt.Println("OpenID:", userIdRsp.Openid)
fmt.Println("UnionID:", userIdRsp.Unionid)
fmt.Println("Errcode:", userIdRsp.Errcode)
fmt.Println("Errmsg:", userIdRsp.Errmsg)</code></pre>
				<!--GetAccessToken-->
				<ul>
					<li id="GetAccessToken">GetAccessToken</li>
				</ul>
				<pre class="line-numbers"><code class="language-go">//获取小程序全局唯一后台接口调用凭据(AccessToken:157字符)
//    appId:APPID
//    appSecret:AppSecret
rsp, err := gopay.GetAccessToken(AppID, APPSecret)
if err != nil {
	fmt.Println("err:", err)
	return
}
fmt.Println("AccessToken:", rsp.AccessToken)
fmt.Println("ExpiresIn:", rsp.ExpiresIn)
fmt.Println("Errcode:", rsp.Errcode)
fmt.Println("Errmsg:", rsp.Errmsg)</code></pre>
				<!--GetPaidUnionId-->
				<ul>
					<li id="GetPaidUnionId">GetPaidUnionId</li>
				</ul>
				<pre class="line-numbers"><code class="language-go">accessToken := "21_3puo3mxoK6Ry2bR7Dh-qdn41wUP1wClwke8Zhf9a_i39jfWRq9rhNJZZZHaOt_Yad-Gp6u9_46dGW0RbIMz3nANInRI3m-1glvCnGW47v63sjYWV1iyTKOHGwDVxEv78kY-0OfkmkiIveVqAZCZaAAAQTQ"
//用户支付完成后，获取该用户的 UnionId，无需用户授权。
//    accessToken：接口调用凭据
//    openId：用户的OpenID
//    transactionId：微信支付订单号
rsp, err := gopay.GetPaidUnionId(accessToken, "o0Df70MSI4Ygv2KQ2cLnoMN5CXI8", "4200000326201905256499385970")
if err != nil {
	fmt.Println("err:", err)
	return
}
fmt.Println("Unionid:", rsp.Unionid)
fmt.Println("Errcode:", rsp.Errcode)
fmt.Println("Errmsg:", rsp.Errmsg)</code></pre>
				<!--GetWeChatUserInfo-->
				<ul>
					<li id="GetWeChatUserInfo">GetWeChatUserInfo</li>
				</ul>
				<pre class="line-numbers"><code class="language-go">accessToken := "21_3puo3mxoK6Ry2bR7Dh-qdn41wUP1wClwke8Zhf9a_i39jfWRq9rhNJZZZHaOt_Yad-Gp6u9_46dGW0RbIMz3nANInRI3m-1glvCnGW47v63sjYWV1iyTKOHGwDVxEv78kY-0OfkmkiIveVqAZCZaAAAQTQ"
//获取用户基本信息(UnionID机制)
//    accessToken：接口调用凭据
//    openId：用户的OpenID
//    lang:默认为 zh_CN ，可选填 zh_CN 简体，zh_TW 繁体，en 英语
userInfo, err := gopay.GetWeChatUserInfo(accessToken, OpenID)
if err != nil {
	fmt.Println("err:", err)
	return
}
fmt.Println("userInfo:", *userInfo)</code></pre>
				<!--DecryptOpenDataToStruct-->
				<ul>
					<li id="DecryptOpenDataToStruct">DecryptOpenDataToStruct</li>
					<ul>
						<li>以小程序获取手机号为例</li>
						<li>button按钮获取手机号码：<a target="_blank" href="https://developers.weixin.qq.com/miniprogram/dev/component/button.html">button组件文档</a></li>
						<li>微信解密算法文档：<a target="_blank" href="https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/signature.html">解密算法文档</a></li>
					</ul>
				</ul>
				<pre class="line-numbers"><code class="language-go">data := "Kf3TdPbzEmhWMuPKtlKxIWDkijhn402w1bxoHL4kLdcKr6jT1jNcIhvDJfjXmJcgDWLjmBiIGJ5acUuSvxLws3WgAkERmtTuiCG10CKLsJiR+AXVk7B2TUQzsq88YVilDz/YAN3647REE7glGmeBPfvUmdbfDzhL9BzvEiuRhABuCYyTMz4iaM8hFjbLB1caaeoOlykYAFMWC5pZi9P8uw=="
iv := "Cds8j3VYoGvnTp1BrjXdJg=="
session := "lyY4HPQbaOYzZdG+JcYK9w=="

phone := new(gopay.WeChatUserPhone)
//解密开放数据
//    encryptedData:包括敏感数据在内的完整用户信息的加密数据
//    iv:加密算法的初始向量
//    sessionKey:会话密钥
//    beanPtr:需要解析到的结构体指针
err := gopay.DecryptOpenDataToStruct(data, iv, session, phone)
if err != nil {
	fmt.Println("err:", err)
	return
}
fmt.Println("PhoneNumber:", phone.PhoneNumber)
fmt.Println("PurePhoneNumber:", phone.PurePhoneNumber)
fmt.Println("CountryCode:", phone.CountryCode)
fmt.Println("Watermark:", phone.Watermark)</code></pre>
				<!--GetOpenIdByAuthCode-->
				<ul>
					<li id="GetOpenIdByAuthCode">GetOpenIdByAuthCode</li>
				</ul>
				<pre class="line-numbers"><code class="language-go">//授权码查询openid
//    appId:APPID
//    mchId:商户号
//    apiKey:ApiKey
//    authCode:用户授权码
//    nonceStr:随即字符串
openIdRsp, err := GetOpenIdByAuthCode(AppID, MchID_iguiyu, ApiKey_iguiyu, "135127679952609396", GetRandomString(32))
if err != nil {
fmt.Println("err:", err)
	return
}
fmt.Println("ReturnCode:", openIdRsp.ReturnCode)
fmt.Println("ReturnMsg:", openIdRsp.ReturnMsg)
fmt.Println("ResultCode:", openIdRsp.ResultCode)
fmt.Println("Appid:", openIdRsp.Appid)
fmt.Println("MchId:", openIdRsp.MchId)
fmt.Println("NonceStr:", openIdRsp.NonceStr)
fmt.Println("err_code:", openIdRsp.ErrCode)
fmt.Println("Openid:", openIdRsp.Openid)</code></pre>

				<!--				-->
				<ul>
					<li>Fast</li>
				</ul>
				<pre class="line-numbers"><code class="language-go">//获取随机字符串
//    length：字符串长度
func GetRandomString(length int) string {
	str := "0123456789AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvWwXxYyZz"
	bytes := []byte(str)
	var result []byte
	r := rand.New(rand.NewSource(time.Now().UnixNano()))
	for i := 0; i < length; i++ {
		result = append(result, bytes[r.Intn(len(bytes))])
	}
	return string(result)
}</code></pre>
				<ul>
					<li>Super Fast</li>
				</ul>
				<pre class="line-numbers"><code class="language-go">//获取随机字符串
//    length：字符串长度
func GetRandomString(length int) string {
	str := "0123456789AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvWwXxYyZz"
	bytes := []byte(str)
	var result []byte
	r := rand.New(rand.NewSource(time.Now().UnixNano()))
	for i := 0; i < length; i++ {
		result = append(result, bytes[r.Intn(len(bytes))])
	}
	return string(result)
}</code></pre>
				<ul>
					<li>Ultra Fast</li>
				</ul>
				<pre class="line-numbers"><code class="language-go">//获取随机字符串
//    length：字符串长度
func GetRandomString(length int) string {
	str := "0123456789AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvWwXxYyZz"
	bytes := []byte(str)
	var result []byte
	r := rand.New(rand.NewSource(time.Now().UnixNano()))
	for i := 0; i < length; i++ {
		result = append(result, bytes[r.Intn(len(bytes))])
	}
	return string(result)
}</code></pre>
				<h3 id="bars_text"> Bars Text</h3>
				<ul>
					<li>Show</li>
				</ul>
				<pre class="line-numbers"><code class="language-go">//获取随机字符串
//    length：字符串长度
func GetRandomString(length int) string {
	str := "0123456789AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvWwXxYyZz"
	bytes := []byte(str)
	var result []byte
	r := rand.New(rand.NewSource(time.Now().UnixNano()))
	for i := 0; i < length; i++ {
		result = append(result, bytes[r.Intn(len(bytes))])
	}
	return string(result)
}</code></pre>
				<ul>
					<li>Hide</li>
				</ul>
				<pre class="line-numbers"><code class="language-go">//获取随机字符串
//    length：字符串长度
func GetRandomString(length int) string {
	str := "0123456789AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvWwXxYyZz"
	bytes := []byte(str)
	var result []byte
	r := rand.New(rand.NewSource(time.Now().UnixNano()))
	for i := 0; i < length; i++ {
		result = append(result, bytes[r.Intn(len(bytes))])
	}
	return string(result)
}</code></pre>
				<h3 id="vote_counter"> Vote Counter</h3>
				<ul>
					<li>Show</li>
				</ul>
				<pre class="line-numbers"><code class="language-go">//获取随机字符串
//    length：字符串长度
func GetRandomString(length int) string {
	str := "0123456789AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvWwXxYyZz"
	bytes := []byte(str)
	var result []byte
	r := rand.New(rand.NewSource(time.Now().UnixNano()))
	for i := 0; i < length; i++ {
		result = append(result, bytes[r.Intn(len(bytes))])
	}
	return string(result)
}</code></pre>
				<ul>
					<li>Hide</li>
				</ul>
				<pre class="line-numbers"><code class="language-go">//获取随机字符串
//    length：字符串长度
func GetRandomString(length int) string {
	str := "0123456789AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvWwXxYyZz"
	bytes := []byte(str)
	var result []byte
	r := rand.New(rand.NewSource(time.Now().UnixNano()))
	for i := 0; i < length; i++ {
		result = append(result, bytes[r.Intn(len(bytes))])
	}
	return string(result)
}</code></pre>
				<h3 id="rating_icons"> Rating Icons</h3>
				<ul>
					<li>Colored</li>
					<li>Grey</li>
				</ul>
				<h3 id="rating_titles"> Rating Titles</h3>
				<ul>
					<li>Text For First Star</li>
				</ul>
				<pre class="line-numbers"><code class="language-go">//获取随机字符串
//    length：字符串长度
func GetRandomString(length int) string {
	str := "0123456789AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvWwXxYyZz"
	bytes := []byte(str)
	var result []byte
	r := rand.New(rand.NewSource(time.Now().UnixNano()))
	for i := 0; i < length; i++ {
		result = append(result, bytes[r.Intn(len(bytes))])
	}
	return string(result)
}</code></pre>
				<ul>
					<li>Text For Second Star</li>
				</ul>
				<pre class="line-numbers"><code class="language-go">//获取随机字符串
//    length：字符串长度
func GetRandomString(length int) string {
	str := "0123456789AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvWwXxYyZz"
	bytes := []byte(str)
	var result []byte
	r := rand.New(rand.NewSource(time.Now().UnixNano()))
	for i := 0; i < length; i++ {
		result = append(result, bytes[r.Intn(len(bytes))])
	}
	return string(result)
}</code></pre>
				<ul>
					<li>Text For Third Star</li>
				</ul>
				<pre class="line-numbers"><code class="language-go">//获取随机字符串
//    length：字符串长度
func GetRandomString(length int) string {
	str := "0123456789AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvWwXxYyZz"
	bytes := []byte(str)
	var result []byte
	r := rand.New(rand.NewSource(time.Now().UnixNano()))
	for i := 0; i < length; i++ {
		result = append(result, bytes[r.Intn(len(bytes))])
	}
	return string(result)
}</code></pre>
				<ul>
					<li>Text For Fourth Star</li>
				</ul>
				<pre class="line-numbers"><code class="language-go">//获取随机字符串
//    length：字符串长度
func GetRandomString(length int) string {
	str := "0123456789AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvWwXxYyZz"
	bytes := []byte(str)
	var result []byte
	r := rand.New(rand.NewSource(time.Now().UnixNano()))
	for i := 0; i < length; i++ {
		result = append(result, bytes[r.Intn(len(bytes))])
	}
	return string(result)
}</code></pre>
				<ul>
					<li>Text For Fifth Star</li>
				</ul>
				<pre class="line-numbers"><code class="language-go">//获取随机字符串
//    length：字符串长度
func GetRandomString(length int) string {
	str := "0123456789AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvWwXxYyZz"
	bytes := []byte(str)
	var result []byte
	r := rand.New(rand.NewSource(time.Now().UnixNano()))
	for i := 0; i < length; i++ {
		result = append(result, bytes[r.Intn(len(bytes))])
	}
	return string(result)
}</code></pre>
				<h3 id="bar_colors"> Bar Colors</h3>
				<ul>
					<li>Colors of Red Bar</li>
					<li>Colors of Yellow Bar</li>
					<li>Colors of Green Bar</li>
				</ul>
			</div>
		</div>
	</section>
	<section class="vibrant centered">
		<div class="">
			<h4> This documentation template is provided by Frittt. You can download and use this template for free.
				Enjoy! :)</h4>
		</div>
	</section>
	<footer>
		<div class="">
			<p> &copy; Copyright Frittt Templates. All Rights Reserved.More Templates</p>
		</div>
	</footer>
</div>
</body>
</html>
